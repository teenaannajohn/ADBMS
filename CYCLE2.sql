USE CYCLE2;
SET SQL_SAFE_UPDATES=0;

#QUESTION SET1
#-----------------------------SAILORS---------------------#
CREATE TABLE SAILORS(SID INT,SNAME VARCHAR(10),RATING INT,AGE INT);
INSERT INTO SAILORS(SID,SNAME,RATING,AGE) 
VALUES(22,'Dustin',7,45),(29,'Brutas',1,33),(31,'Lubber',8,55),(32,'Andy',8,25),(58,'Rusty',10,35),
(64,'Horatio',7,35),(71,'Zorba',10,16),(74,'Horatio',9,35),(85,'Art',3,26),(95,'Bob',3,64);
SELECT * FROM SAILORS;
#-----------------------------BOATS----------------------#
CREATE TABLE BOATS(BID INT,BNAME VARCHAR(10),COLOR VARCHAR(10));
INSERT INTO BOATS(BID,BNAME,COLOR) VALUES(101,'Interlake','Blue'),(102,'Interlake','Red'),(103,'Clipper','Green'),(104,'Marine','Red');
SELECT * FROM BOATS;
#ALTER TABLE BOATS RENAME COLUMN SID TO BID;
#---------------------------RESERVES---------------------#
CREATE TABLE RESERVS(SID INT,BID INT,DAY DATE);
INSERT INTO RESERVS(SID,BID,DAY) 
VALUES(22,101,'98/10/10'),(22,102,'1998/10/10'),(22,103,'1998/8/10'),(22,104,'1998/7/10'),(31,102,'1998/10/11');
INSERT INTO RESERVS(SID,BID,DAY) 
VALUES(31,103,'1998/06/11'),(31,104,'1998/12/11'),(64,101,'1998/05/9'),(64,102,'1998/08/09'),(74,103,'1998/08/09');
SELECT * FROM RESERVS;

#-----------QUESTIONS----------#
SELECT SNAME,AGE FROM SAILORS;

SELECT * FROM SAILORS S ,RESERVS R WHERE S.SID=R.SID AND R.BID=101;

SELECT SNAME,RATING FROM SAILORS WHERE RATING>7;

SELECT DISTINCT SNAME FROM SAILORS S,RESERVS R,BOATS B WHERE S.SID=R.SID AND R.BID=103 AND B.BID=R.BID;

SELECT DISTINCT SNAME FROM SAILORS S,RESERVS R,BOATS B WHERE S.SID=R.SID AND R.BID=B.BID AND B.COLOR='RED' ORDER BY S.AGE;

SELECT DISTINCT S.SNAME FROM SAILORS S,RESERVS R,BOATS B WHERE S.SID=R.SID AND R.BID=B.BID AND B.COLOR='RED' OR B.COLOR='GREEEN';

SELECT DISTINCT COLOR FROM BOATS B,SAILORS S,RESERVS R WHERE S.SID=R.SID AND R.BID=B.BID AND S.SNAME='LUBBER';

SELECT DISTINCT SNAME FROM SAILORS S,RESERVS R,BOATS B WHERE S.SID=R.SID AND R.BID=B.BID AND B.COLOR='RED' AND 
EXISTS (SELECT DISTINCT SNAME FROM SAILORS S,RESERVS R,BOATS B WHERE S.SID=R.SID AND R.BID=B.BID AND B.COLOR='GREEN');

SELECT DISTINCT SNAME FROM SAILORS S,RESERVS R WHERE S.SID=R.SID;

SELECT DISTINCT S.SID,S.SNAME FROM SAILORS S,RESERVS R WHERE S.SID=R.SID GROUP BY R.DAY,S.SNAME,S.SID HAVING COUNT(R.DAY)>1;

SELECT SNAME,AGE FROM SAILORS WHERE AGE=(SELECT MIN(AGE) FROM SAILORS);

SELECT SNAME,RATING FROM SAILORS WHERE RATING > (SELECT MAX(RATING) FROM SAILORS WHERE SNAME="HORATIO");

#SELECT sname,sid FROM(SELECT sname,reservs.sid,COUNT(bid) AS id FROM RESERVS,SAILORS WHERE reservs.sid = sailors.sid
#GROUP BY reservs.SID,sname) a WHERE id =( SELECT COUNT(bid) FROM BOATS );

SELECT COUNT(SNAME) FROM (SELECT DISTINCT SNAME FROM SAILORS)S;

SELECT AVG(AGE) FROM SAILORS;

SELECT RATING,AVG(AGE) FROM SAILORS GROUP BY RATING;

SELECT A.RATING,B.MEAN FROM(SELECT RATING FROM SAILORS GROUP BY RATING HAVING COUNT(SNAME)>1) A,(SELECT RATING,AVG(AGE) AS MEAN FROM SAILORS GROUP BY RATING) B 
WHERE A.RATING=B.RATING;

#QUESTION SET2

CREATE TABLE STUDENT_INFO (SID INT UNIQUE PRIMARY KEY ,STUD_NAME VARCHAR(15) NOT NULL,STUD_SCORE INT DEFAULT 20);
UPDATE STUDENT_INFO SET STUD_SCORE=CASE WHEN STUD_SCORE>150 THEN 5 END;

CREATE TABLE WORKER(WORKER_ID INT PRIMARY KEY,FIRST_NAME VARCHAR(15),LAST_NAME VARCHAR(15),SALARY INT,JOINING_DATE DATE,DEPARTMENT VARCHAR(10));
INSERT INTO WORKER(WORKER_ID,FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE,DEPARTMENT) VALUES(1,'Monika','Arora',100000,'2014-02-20','HR'),
(2,'Niharika','Verma',80000,'2014-06-11','Admin'),(3,'Vishal','Singhal',300000,'2014-02-20','HR'),(4,'Amitabh','Singh',500000,'2014-02-20','Admin'),
(5,'Vivek','Bhati',500000,'2014-06-11','Admin'),(6,'Vipul','Diwan',200000,'2014-06-11','Account'),(7,'Satish','Kumar',75000,'2014-01-20','Account'),
(8,'Geetika','Chauhan',90000,'2014-04-11','Admin');
SELECT * FROM WORKER;

CREATE TABLE BONUS(WORKER_ID INT,BONUS_DATE DATE,BONUS_AMOUNT INT,
CONSTRAINT FK FOREIGN KEY(WORKER_ID) REFERENCES WORKER(WORKER_ID) ON UPDATE CASCADE ON DELETE CASCADE);
INSERT INTO BONUS(WORKER_ID,BONUS_DATE,BONUS_AMOUNT)VALUES(1,'2016-02-20',5000),(2,'2016-06-11',3000),
(3,'2016-02-20',4000),(1,'2016-02-20',4500),(2,'2016-06-11',3500);
SELECT * FROM BONUS;

SELECT FIRST_NAME AS WORKER_NAME FROM WORKER;

SELECT * FROM WORKER ORDER BY FIRST_NAME ASC;

SELECT * FROM WORKER WHERE FIRST_NAME NOT IN('Vipul','Satish');

SELECT * FROM WORKER WHERE DEPARTMENT='Admin';

SELECT * FROM WORKER WHERE SALARY BETWEEN 100000 AND 500000;

SELECT UPPER(FIRST_NAME) AS FIRST_NAME FROM WORKER;

SELECT DISTINCT DEPARTMENT FROM WORKER;

SELECT SUBSTRING(FIRST_NAME,1,3) AS FIRST_NAMEE FROM WORKER;

SELECT RTRIM(FIRST_NAME) AS RTRIM_FRIST_NAME FROM WORKER; 

SELECT LTRIM(FIRST_NAME) AS LTRIM_FRIST_NAME FROM WORKER; 

SELECT DISTINCT DEPARTMENT,LENGTH(DEPARTMENT) AS DEPARTMENT_LENGTH  FROM WORKER;

SELECT REPLACE(FIRST_NAME,'a','A') AS FIRST_NAME FROM WORKER;

SELECT FIRST_NAME,LAST_NAME,SALARY,DEPARTMENT,BONUS_AMOUNT FROM WORKER W,BONUS B WHERE W.WORKER_ID=B.WORKER_ID AND B.BONUS_AMOUNT>4000; 

DELETE FROM WORKER WHERE WORKER_ID=7;
SELECT * FROM WORKER;
SELECT * FROM BONUS;

ALTER TABLE BONUS DROP CONSTRAINT FK;
ALTER TABLE BONUS ADD CONSTRAINT FK_NEW FOREIGN KEY(WORKER_ID) REFERENCES WORKER(WORKER_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

DELETE FROM WORKER WHERE WORKER_ID=8;


#QUESTION SET 3

CREATE TABLE CUSTOMER(CUST_ID INT PRIMARY KEY,CUST_NAME VARCHAR(10));
CREATE TABLE ITEM(ITEM_ID INT PRIMARY KEY,ITEM_NAME VARCHAR(20),PRICE INT);
CREATE TABLE SALE(BILL_NO INT PRIMARY KEY,BILL_DATE DATE,CUST_ID INT,ITEM_ID INT,QTY_SOLID INT,
CONSTRAINT FK_CUST FOREIGN KEY(CUST_ID) REFERENCES CUSTOMER(CUST_ID),CONSTRAINT FK_IEM FOREIGN KEY(ITEM_ID) REFERENCES ITEM(ITEM_ID));

INSERT INTO CUSTOMER(CUST_ID,CUST_NAME) VALUES(1,'Rekha'),(2,'Rani'),(3,'Rocky'),(4,'Xin'),(5,'Kim');
SELECT * FROM CUSTOMER;
INSERT INTO ITEM(ITEM_ID,ITEM_NAME,PRICE) VALUES(1,'Rusk',120),(2,'Banana',50),(3,'Sanitizer',60),(4,'Cake',420),(5,'Laddu',25);
SELECT * FROM ITEM;
INSERT INTO SALE(BILL_NO,BILL_DATE,CUST_ID,ITEM_ID,QTY_SOLID) VALUES(10,'2020/10/01',1,1,3),(11,'2020/10/01',1,3,2),(12,'2020/10/01',1,5,7),
(13,'2018/10/01',4,4,1),(14,'2018/10/11',4,2,2),(15,'2018/09/29',5,1,5),(16,'2018/12/25',3,1,5),(17,'1995/06/21',5,4,4),(18,'2002/04/01',4,5,5),
(19,'2020/02/12',1,2,3),(20,'2020/10/01',1,5,7);
SELECT * FROM SALE;

SELECT * FROM CUSTOMER C,ITEM I,SALE S WHERE C.CUST_ID=S.CUST_ID AND I.ITEM_ID=S.ITEM_ID AND I.PRICE>200;

SELECT C.CUST_ID,CUST_NAME,SC.COUNT,SC.BILL_DATE FROM CUSTOMER C,
(SELECT COUNT(ITEM_ID) AS COUNT,BILL_DATE,CUST_ID FROM SALE GROUP BY BILL_DATE) SC WHERE C.CUST_ID=SC.CUST_ID;

SELECT C.CUST_ID,CUST_NAME,SC.COUNT,SC.BILL_DATE FROM CUSTOMER C,
(SELECT COUNT(ITEM_ID) AS COUNT,BILL_DATE,CUST_ID FROM SALE GROUP BY BILL_DATE) SC WHERE C.CUST_ID=SC.CUST_ID AND YEAR(BILL_DATE)=2018;

SELECT ITEM_NAME,I.ITEM_ID FROM ITEM I,CUSTOMER C,SALE S WHERE S.CUST_ID=C.CUST_ID AND S.ITEM_ID=I.ITEM_ID AND C.CUST_ID=5;

SELECT ITEM_NAME,S.BILL_DATE FROM ITEM I,SALE S WHERE I.ITEM_ID=S.ITEM_ID AND S.BILL_DATE=CURDATE();






















